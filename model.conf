[request_definition]
# API请求
# 角色 域 对象 行为 
r = sub, domain, obj, act

[policy_definition]
# API策略
# 角色 域 对象 行为
p = sub, domain, obj, act

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
# 优先级从高到低:
# 1. root 超级管理员
# 2. superadmin 跨域管理员
# 3. 域自定义角色(精确匹配)
# 4. 基础角色(全局匹配)
m = r.sub == "root" || (r.sub == "superadmin" && (p.domain == "*" || r.domain == p.domain)) || (r.sub == p.sub && r.domain == p.domain && keyMatch5(r.obj, p.obj) && r.act == p.act) || (r.sub == p.sub && p.domain == "*" && keyMatch5(r.obj, p.obj) && r.act == p.act)